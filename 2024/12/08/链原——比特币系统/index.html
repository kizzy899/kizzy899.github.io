<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>链原——比特币系统 | EIGHTJIU</title><meta name="author" content="kizy"><meta name="copyright" content="kizy"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="比特币区块链系统架构背景：比特币系统作为世界上第一个大规模成功运营的区块链系统，也建立了区块链系统体系结构的标准——P2P体系结构，即对等网络结构。  每个节点都通过底层的P2P网络协议发现、连接其它区块链网络节点，并提供P2P网络的路由功能；  个节点可以通过PoW共识机制竞争计算新区块的出块权（俗称“挖矿”）；  每个节点都可以存储完整的区块链与账本数据，每个节点都可以发起和监听比特币网络上的">
<meta property="og:type" content="article">
<meta property="og:title" content="链原——比特币系统">
<meta property="og:url" content="https://kizzy899.github.io/2024/12/08/%E9%93%BE%E5%8E%9F%E2%80%94%E2%80%94%E6%AF%94%E7%89%B9%E5%B8%81%E7%B3%BB%E7%BB%9F/index.html">
<meta property="og:site_name" content="EIGHTJIU">
<meta property="og:description" content="比特币区块链系统架构背景：比特币系统作为世界上第一个大规模成功运营的区块链系统，也建立了区块链系统体系结构的标准——P2P体系结构，即对等网络结构。  每个节点都通过底层的P2P网络协议发现、连接其它区块链网络节点，并提供P2P网络的路由功能；  个节点可以通过PoW共识机制竞争计算新区块的出块权（俗称“挖矿”）；  每个节点都可以存储完整的区块链与账本数据，每个节点都可以发起和监听比特币网络上的">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://kizzy899.github.io/cover/cover11.jpg">
<meta property="article:published_time" content="2024-12-07T16:00:07.000Z">
<meta property="article:modified_time" content="2024-12-14T14:39:03.884Z">
<meta property="article:author" content="kizy">
<meta property="article:tag" content="区块链">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://kizzy899.github.io/cover/cover11.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "链原——比特币系统",
  "url": "https://kizzy899.github.io/2024/12/08/%E9%93%BE%E5%8E%9F%E2%80%94%E2%80%94%E6%AF%94%E7%89%B9%E5%B8%81%E7%B3%BB%E7%BB%9F/",
  "image": "https://kizzy899.github.io/cover/cover11.jpg",
  "datePublished": "2024-12-07T16:00:07.000Z",
  "dateModified": "2024-12-14T14:39:03.884Z",
  "author": [
    {
      "@type": "Person",
      "name": "kizy",
      "url": "https://kizzy899.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/tubiao.png"><link rel="canonical" href="https://kizzy899.github.io/2024/12/08/%E9%93%BE%E5%8E%9F%E2%80%94%E2%80%94%E6%AF%94%E7%89%B9%E5%B8%81%E7%B3%BB%E7%BB%9F/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '链原——比特币系统',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/_custom/custom.css"><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(/img/aaaset/page.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/aaaset/touxiang.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">67</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">10</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/search/"><i class="fa-fw fas fa-search"></i><span> Search</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> link</span></a></li><li><a class="site-page child" href="/star/"><i class="fa-fw fas fa-star"></i><span> star</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/cover/cover11.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">EIGHTJIU</span></a><a class="nav-page-title" href="/"><span class="site-name">链原——比特币系统</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/search/"><i class="fa-fw fas fa-search"></i><span> Search</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> link</span></a></li><li><a class="site-page child" href="/star/"><i class="fa-fw fas fa-star"></i><span> star</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></li></ul></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">链原——比特币系统</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-12-07T16:00:07.000Z" title="发表于 2024-12-08 00:00:07">2024-12-08</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-12-14T14:39:03.884Z" title="更新于 2024-12-14 22:39:03">2024-12-14</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h2 id="比特币区块链系统架构"><a href="#比特币区块链系统架构" class="headerlink" title="比特币区块链系统架构"></a><strong>比特币区块链系统架构</strong></h2><p><strong>背景</strong>：比特币系统作为世界上第一个大规模成功运营的区块链系统，也建立了区块链系统体系结构的标准——P2P体系结构，即对等网络结构。</p>
<ul>
<li><p>每个节点都通过底层的P2P网络协议发现、连接其它区块链网络节点，并提供P2P网络的路由功能；</p>
</li>
<li><p>个节点可以通过PoW共识机制竞争计算新区块的出块权（俗称“挖矿”）；</p>
</li>
<li><p>每个节点都可以存储完整的区块链与账本数据，每个节点都可以发起和监听比特币网络上的交易信息，验证每个交易和区块的合法性</p>
</li>
</ul>
<h3 id="关于节点"><a href="#关于节点" class="headerlink" title="关于节点"></a>关于节点</h3><p><strong>节点总体上可以分为“全节点”、“轻节点”等两大类，其中发挥核心作用的是全节点。</strong></p>
<h4 id="全节点"><a href="#全节点" class="headerlink" title="全节点"></a>全节点</h4><ul>
<li><p><strong>全节点是比特币系统中功能最完整的节点</strong>，全节点一般要求保持一直在线，主要负责执行以下功能：</p>
</li>
<li><p><strong>参与区块记账权的竞争</strong>，通过PoW共识机制竞争下一个新区块的出块权，获得出块权的节点将获得系统激励，激励的方式就是奖励一定数量的比特币，也是比特币这种加密货币的唯一产生来源。</p>
</li>
<li><p><strong>存储完整的区块链与账本数据</strong>，每个全节点都保存了一个相同区块链与账本数据副本，自2009年比特币系统上线运行至今，每个全节点的区块链与账本数据存储容量已超过500GB。</p>
</li>
<li><p><strong>提供P2P网络路由与同步服务</strong>，监听系统网络上的交易、区块及事件信息，对接收到的交易和区块数据进行验证，并通过Gossip协议进行数据分发与同步。</p>
</li>
</ul>
<h4 id="轻节点"><a href="#轻节点" class="headerlink" title="轻节点"></a>轻节点</h4><ul>
<li><strong>轻节点主要负责提供交易和钱包功能，不参与出块权的竞争计算，不会存储完整的区块链，只需要保存每个区块的区块头信息</strong>，以及与节点自身相关的交易信息，可以发起简单支付验证请求SPV（Simplified Payment Verification），向全节点请求数据来验证交易，也提供P2P网络的路由功能。</li>
</ul>
<h3 id="系统逻辑架构"><a href="#系统逻辑架构" class="headerlink" title="系统逻辑架构"></a><strong>系统逻辑架构</strong></h3><p><img src="https://s2.loli.net/2024/12/08/EJ1BiRgwbcCTXlM.png" alt="1.png"></p>
<ol>
<li><p>比特币系统的<strong>存储层</strong>主要采用文件系统和LevelDBKey-Value数据库</p>
</li>
<li><p>比特币系统的<strong>数据层</strong>是系统核心功能层级之一。</p>
<p><strong>主要功能</strong>：</p>
<ul>
<li>对比特币系统核心的区块、区块链、交易、账本、地址等关键数据结构进行定义和处理</li>
<li>负责将交易打包进区块，由区块组成区块链</li>
<li>没有采用传统的账户&#x2F;余额模型，而是采用特殊的UTXO模型构建账本数据，并基于底层的存储服务提供对比特币区块链数据的安全读写访问管理。</li>
</ul>
</li>
<li><p>比特币系统的<strong>网络层</strong>是系统核心功能层级之一，主要采用非结构化P2P网络，基于Gossip数据分发协议</p>
<p><strong>主要功能</strong>：</p>
<ul>
<li>实现网络节点快速发现与连接，以及区块、交易数据的分发与同步</li>
<li>为比特币系统各网络节点之间提供节点发现与安全连接通信机制</li>
<li>为交易、区块信息在区块链网络所有节点之间提供高效传播与有效性验证机制。</li>
</ul>
</li>
<li><p>比特币系统的<strong>共识层</strong>是系统核心功能层级之一，采用PoW工作量证明共识机制</p>
</li>
</ol>
<p>​	<strong>主要功能</strong>： </p>
<ul>
<li>​			让所有的比特币网络节点都认可每次计算产生的新区块</li>
<li>​	 	并且协调保证所有比特币网络节点数据记录一致性，使比特币系统的整体状态达成一致。</li>
</ul>
<ol start="5">
<li><p>比特币系统的<strong>激励层</strong>在共识层的功能基础上，提供了总量有限的比特币发行和出块激励机制，对于加入比特币网络的节点，都能公平地通过参与PoW工作量证明竞争计算，都有一定机率被区块链系统增发奖励一定数量的比特币。</p>
</li>
<li><p>比特币系统的<strong>合约层</strong>没有提供真正意义的智能合约功能，而是基于一种非图灵完备的、基于逆波兰表示法的Script脚本语言开发技术，提供交易相关<strong>锁定脚本&#x2F;解锁脚本</strong>的定制。</p>
</li>
</ol>
<hr>
<p>什么是锁定脚本&#x2F;解锁脚本?</p>
<hr>
<ol start="7">
<li><p>比特币系统的<strong>接口层</strong>提供了基于JSON RPC的SDK接口和命令行接口。</p>
</li>
<li><p>比特币系统的<strong>应用层</strong>基于接口层提供的SDK接口，可以基于比特币区块链实现面向电子支付等多种应用场景和业务逻辑的公有链应用</p>
</li>
</ol>
<h2 id="比特币系统数据层"><a href="#比特币系统数据层" class="headerlink" title="比特币系统数据层"></a><strong>比特币系统数据层</strong></h2><h3 id="区块与区块链"><a href="#区块与区块链" class="headerlink" title="区块与区块链"></a><strong>区块与区块链</strong></h3><p>   在比特币系统中，<strong>区块（Block）是区块链系统中最基本的数据单元，用于表示和记录区块链系统一段时间内发生的交易和状态结果</strong>的数据结构，是区块链系统各节点竞争完成一次共识计算的结果，多个区块采用链式结构链接在一起就构成了区块链（Blockchain）。每个区块<strong>又由区块头（Block Head）和区块体（Block Body）</strong>两部分组成。</p>
<p><img src="https://s2.loli.net/2024/12/08/ODqwtiFVTS9A2uz.png" alt="2.png"></p>
<p>在区块链系统的所有区块中，<strong>第一个区块被称为“创世区块”</strong>。每个区块中存储了一定数量的交易数据，都由交易发起人的数字签名来保证其真实性和合法性，从第二个区块开始，每个区块都保存了前一个区块（父区块）的区块头的哈希值，<strong>区块之间首尾相互连接就构成链式结构，因而先前区块里的任何数据都不可被篡改</strong></p>
<p><img src="https://s2.loli.net/2024/12/08/FTeoXCIjDL68cZ1.png" alt="3.png"></p>
<p><img src="https://s2.loli.net/2024/12/08/7HCfYpGqniOxhR1.png" alt="5.png"></p>
<h4 id="账本数据"><a href="#账本数据" class="headerlink" title="账本数据"></a>账本数据</h4><p><strong>在一个传统的具有支付功能的系统中，每个用户都有一个资金账户，支付系统会对每个账户的余额进行单独地记录和管理。当系统中有用户之间发生了支付的交易，系统会分别对参与交易的账户的余额信息进行检查和修改。</strong></p>
<p>（例如，甲向乙转账50元，首先需要检查甲的账户中有50元的余额，再从甲的账户中扣除50元，并向乙的账户中添加50元。可以看到，为了保证整个系统的正确性，系统需要确保对应的支付前提条件，如甲的账户中至少有50元的余额，同时也需要<strong>保证整个支付交易过程的原子性、一致性、隔离性及持久性（ACID）</strong>，即保证从甲账户扣减金额和向乙账户增加相同数量的金额这两个操作必须同时执行和完成，一旦受其他事件影响中断，甲和乙的账户必须恢复到交易前的状态。）</p>
<p>在比特币系统中没有直接的“账户”概念，而是用“账户地址”来代表用户的账户，相当于银行卡卡号，任何人都可以通过你的账户地址给你转账比特币。</p>
<p>​    <strong>(1)</strong> <strong>账户地址</strong></p>
<p>​    <strong>比特币的账户地址就是用户的公钥经过哈希计算及Base58编码运算后生成的160位（20字节）的字符串，账户地址计算生成流程。</strong></p>
<p><img src="https://s2.loli.net/2024/12/08/2kw4OhunQXGs8fC.png" alt="4.png"></p>
<h4 id="UTXO"><a href="#UTXO" class="headerlink" title="UTXO"></a>UTXO</h4><p>   <strong>(2)</strong> <strong>账本数据模型</strong></p>
<p>​    <strong>比特币系统账本没有采用传统的“账户&#x2F;余额”模型，而是提出了一种独特的UTXO（Unspent Transaction Output）未消费的交易输出模型，简称比特币UTXO模型。UTXO是一个包含交易数据和对应的执行代码的数据结构，所有的UTXO条目构成了比特币系统的“账本”。</strong></p>
<p>​    <strong>UTXO模型的本质是通过交易记录来构成系统账本，而不是通过账户信息构成账本。在比特币的每一笔支付交易中，都有“交易输入”（标识资金来源）和“交易输出”（标识资金去向），且每个交易都可以有多个交易输入和多个交易输出，交易之间按照时间戳的先后顺序排列，且任何一个交易中的交易输入都是其前序的某个交易中产生的“交易输出”，而所有交易的最初的交易输入都来自比特币系统节点生成区块得到的激励（比特币）。</strong></p>
<p>比特币系统中的每个“账户”可以视为对应着某个地址，比特币区块链不会直接跟踪每个地址的比特币余额，而是在区块链中存储交易数据的整个历史，比特币系统通过“交易池”跟踪区块链网络中所有UTXO的集合，而某个地址在某个时间点所具有的“余额”，是通过检查、求和与该地址相关的所有UTXO来计算。当使用UTXO时，它将从交易池中被删除，这将实时在计算余额时反映出来。</p>
<h4 id="交易数据结构"><a href="#交易数据结构" class="headerlink" title="交易数据结构"></a><strong>交易数据结构</strong></h4><p>​    在比特币的每一笔交易数据中，都包含一个或多个“交易输入”（标识资金来源）、一个或多个“交易输出”（标识资金去向）、交易时间戳等信息。</p>
<p><img src="https://s2.loli.net/2024/12/08/VK5SRgFi2ayNOCr.png" alt="6.png"></p>
<h5 id="交易输入数据结构"><a href="#交易输入数据结构" class="headerlink" title="交易输入数据结构"></a>交易输入数据结构</h5><h5 id="交易输出数据结构"><a href="#交易输出数据结构" class="headerlink" title="交易输出数据结构"></a>交易输出数据结构</h5><h4 id="状态数据"><a href="#状态数据" class="headerlink" title="状态数据"></a>状态数据</h4><p>在比特币系统中，交易表示一次价值转移操作，会导致账本状态的一次改变，如增加了一条交易记录；区块表示记录一段时间内发生的交易和状态结果，是对当前账本状态的一次共识和确认；链是由一个个区块按照发生时间顺序串联而成，可以看作是整个区块链状态变化的日志记录。</p>
<p><strong><strong>在一个比特币区块的区块头中包含了Merkle树根的哈希值，在区块体中包含了所有经过验证的交易数据。区块体中所有交易数据的哈希值构成了一棵Merkle树，每个叶子节点是每个交易信息的哈希值，将该Merkle树的根节点的值，称根哈希（Root Hash）或主哈希（Master Hash），存入区块头。</strong></strong></p>
<h3 id="比特币系统网络层"><a href="#比特币系统网络层" class="headerlink" title="比特币系统网络层"></a><strong>比特币系统网络层</strong></h3><h4 id="P2P网络结构"><a href="#P2P网络结构" class="headerlink" title="P2P网络结构"></a><strong>P2P网络结构</strong></h4><p><strong>比特币系统采用的P2P网络属于非结构化P2P网络，不存在中心服务器，比特币网络中存在“全节点”、“轻节点”等不同类型的节点，不同类型的节点在网络中扮演的角色也有所不同，其中发挥核心作用的是全节点。</strong></p>
<h4 id="全节点-1"><a href="#全节点-1" class="headerlink" title="全节点"></a><strong>全节点</strong></h4><p>全节点要一直在线，是比特币P2P网络中功能最完整的节点，全节点要竞争计算新区块的出块权，会存储完整的区块链数据，要监听比特币网络上的交易信息，验证每个交易的合法性，并提供P2P网络的路由功能。</p>
<h4 id="轻节点-1"><a href="#轻节点-1" class="headerlink" title="轻节点"></a><strong>轻节点</strong></h4><p>​    <strong>轻节点不需要一直在线，不参与出块权的竞争计算，不会存储完整的区块链，只需要保存每个区块的区块头信息，以及与自己相关的交易信息，可以发起简单支付验证请求SPV，向全节点请求数据来验证交易，并提供P2P网络的路由功能。轻节点除了主要提供交易功能外，还常常提供钱包功能。</strong></p>
<p>​    比特币系统的P2P网络基于TCP构建，默认RPC通信服务端口是8332，默认数据同步端口是8333，比特币系统的P2P网络主要采用了Gossip协议来实现节点发现、节点连接、区块广播、交易广播等功能。</p>
<h4 id="节点发现管理"><a href="#节点发现管理" class="headerlink" title="节点发现管理"></a><strong>节点发现管理</strong></h4><h4 id="交易广播"><a href="#交易广播" class="headerlink" title="交易广播"></a><strong>交易广播</strong></h4><p>在比特币系统中，节点为了向比特币系统发送一笔交易，需要向<strong>邻近的对等全节点</strong>发送Inv消息。如果接收到对等节点返回的GetData消息，节点再使用Tx消息向对等节点发送交易信息。对等节点接收到交易信息后，将以同样的方式向其它邻近节点转发交易信息。</p>
<p><img src="https://s2.loli.net/2024/12/08/p6GxrhvizQmdLHN.png" alt="7.png"></p>
<h4 id="交易池"><a href="#交易池" class="headerlink" title="交易池"></a><strong>交易池</strong></h4><p>比特币网络中每个节点都会维护一个未确认交易列表，称为“交易池”。节点使用交易池记录并跟踪等待被区块链系统确认的交易。例如，具有钱包功能的节点会使用交易池来记录那些已发送到网络但还未被确认的，只与该节点上的钱包相关的预支付交易信息。</p>
<p><strong>某些节点还维护一个单独的“孤立交易池”。所谓“孤立交易”是指，如果一个交易的输入与某未知的交易有关，如与缺失的父交易相关，该孤立交易就会被暂时存储在孤立交易池中直到父交易的信息到达。当一个交易被添加到交易池时，会同时检查孤立交易池，看是否有某个孤立交易引用了此交易的输出（子交易）。任何匹配的孤立交易会被进行验证。如果验证有效，它们会从孤立交易池中删除，并添加到交易池中。</strong></p>
<h4 id="区块广播与同步"><a href="#区块广播与同步" class="headerlink" title="区块广播与同步"></a><strong>区块广播与同步</strong></h4><h3 id="比特币系统共识层"><a href="#比特币系统共识层" class="headerlink" title="比特币系统共识层"></a><strong>比特币系统共识层</strong></h3><h4 id="PoW工作量证明共识机制"><a href="#PoW工作量证明共识机制" class="headerlink" title="PoW工作量证明共识机制"></a><strong>PoW工作量证明共识机制</strong></h4><p>比特币系统通过共识机制竞争计算生成新区块的过程，被称为“挖矿（Mine)”，因此比特币网络节点又被称为“矿工（Miner）”，后续如以太坊等其它区块链系统都延用了这种说法。</p>
<p><img src="https://s2.loli.net/2024/12/08/9ps7xHWcMnYlF43.png" alt="8.png"></p>
<h4 id="PoW共识机制的特点"><a href="#PoW共识机制的特点" class="headerlink" title="PoW共识机制的特点"></a><strong>PoW共识机制的特点</strong></h4><p><strong>比特币系统的PoW共识机制具有两大特点</strong>：</p>
<p>(1) 比特币系统PoW共识机制采用的“难题”具有难以解答，但很容易验证答案的正确性的特点，同时求解难题的“难度”，即比特币网络节点平均解出一个难题所消耗时间，是可以通过调整难题中的部分参数来进行控制的，因此比特币系统可以很好地控制链增长的速度；</p>
<p>(2) 通过控制区块链的增长速度，保证了如果一个节点成功解出难题完成了新区块的创建，该区块能够以更快的速度在所有节点之间传播，并且得到其他节点的验证，再结合比特币系统所采取的“最长链有效”的评判机制，就能够在大多数（超过比特币网络51%算力）节点都是诚实的情况下，避免恶意节点对区块链的控制。</p>
<h4 id="竞争出块冲突"><a href="#竞争出块冲突" class="headerlink" title="竞争出块冲突"></a><strong>竞争出块冲突</strong></h4><h3 id="比特币系统激励层"><a href="#比特币系统激励层" class="headerlink" title="比特币系统激励层"></a><strong>比特币系统激励层</strong></h3><h4 id="激励机制"><a href="#激励机制" class="headerlink" title="激励机制"></a>激励机制</h4><p><strong>在比特币系统中，比特币网络约每10分钟生成一个不超过1MB大小的区块，用于记录这10分钟内发生的验证过的交易内容，并将区块串联到最长的链尾部，每个区块的成功提交者可以得到系统一定数量的比特币的奖励（该奖励将作为区块内的第一个CoinBase交易，并将在一定区块数后才能使用），以及用户附加到交易上的支付服务费用。因此，即使没有任何用户交易，比特币网络也可以自行产生合法的区块并生成奖励。每个区块的奖励最初是50个比特币，每隔21万个区块（约4年时间）自动减半，最终比特币总量稳定在2100万个</strong></p>
<p><strong>比特币系统的激励机制主要包括以下要点：</strong></p>
<p>(1)加密货币总量固定：比特币总量不超过 2100 万个。</p>
<p>(2)出块激励：每当有节点获得一个区块的记账权，比特币系统就会发行出新的比特币作为对节点的奖励。一个区块产生的比特币数量都会按几何级数递减，每产出 21 万个区块，获得奖励的比特币数量就会减少 50% 。截至2022年，每个区块的奖励已降低为6.25个比特币，是比特币系统上线时的八分之一。</p>
<p>(3)交易激励：用户会在交易中包含交易费，作为处理交易的服务费支付给获得区块记账权的节点。</p>
<h3 id="比特币系统合约层"><a href="#比特币系统合约层" class="headerlink" title="比特币系统合约层"></a><strong>比特币系统合约层</strong></h3><h4 id="比特币系统的交易脚本"><a href="#比特币系统的交易脚本" class="headerlink" title="比特币系统的交易脚本"></a>比特币系统的交易脚本</h4><p>比特币系统没有账户机制，而采用了一种比较特别的 UTXO交易模型，类似于财务会计记账方法，每一笔交易数据主要包括两部分：交易输入记录和交易输出记录。</p>
<p>   （1）交易输出记录中除了包含输出比特币金额外，还包含了称为“锁定脚本”的一段脚本代码。</p>
<p>   （2）交易输入记录中除了包含对前一个交易输出部分的引用外，还包含了称为“解锁脚本”的一段脚本代码。</p>
<h4 id="交易脚本执行机制"><a href="#交易脚本执行机制" class="headerlink" title="交易脚本执行机制"></a><strong>交易脚本执行机制</strong></h4><p><strong>图灵完备性</strong></p>
<p><strong>逆波兰表示法</strong></p>
<h4 id="交易标准脚本"><a href="#交易标准脚本" class="headerlink" title="交易标准脚本"></a><strong>交易标准脚本</strong></h4><p><strong>（一）填空题</strong></p>
<p><strong>1. 在比特币系统中，每个区块又由      和      两部分组成。</strong></p>
<p><strong>2.    年  月，随着比特币区块链系统生成了第一个区块，标志着世界上第一个区块链系统的诞生。</strong></p>
<p><strong>3. 比特币的标准单位是      ，最小单位是      ，1个标准单位的比特币等于       个最小单位的比特币。</strong></p>
<p><strong>4. 比特币系统的发行量每四年减半，总量上限为    万枚，并且无法被超发。</strong></p>
<p><strong>5. 比特币网络中存在     、     等不同类型的节点，不同类型的节点在网络中扮演的角色也有所不同。</strong></p>
<p><strong>6. 比特币系统每个区块的区块体所包含的交易记录列表，实际上就是可以用于唯一标识与检索指定交易的交易哈希值列表，区块头中将存储由所有交易哈希值构造的     树的根哈希值。</strong></p>
<p><strong>（二）选择题</strong></p>
<p><strong>1. 在区块链系统的所有区块中，第一个区块被称为（   ）。</strong></p>
<p><strong>A. 初始区块    B. 创世区块      C. 元区块      D. 头区块</strong></p>
<p><strong>2. 在比特币系统区块链的每个区块的区块头中会保存多个哈希值，但没有保存（   ）。</strong></p>
<p><strong>A. 当前区块整体的哈希值         B. 当前区块的区块头的哈希</strong></p>
<p><strong>C. 前一个区块的区块头的哈希值      D. 下一个区块的区块头的哈希值</strong></p>
<p><strong>3. 比特币系统采用（   ）模型，通过交易记录来构成系统账本。</strong></p>
<p><strong>A. UTXO      B. 账户       C. 数据库       D. 会计</strong></p>
<p><strong>4. 比特币的账户地址就是（   ）经过一系列哈希计算及Base58编码运算后生成的160位（20字节）的字符串。</strong></p>
<p><strong>A. 用户私钥    B. 用户公钥     C. 随机数       D. 节点IP地址</strong></p>
<p><strong>5. 在比特币系统中，每一笔交易数据中不包含的是（    ）。</strong></p>
<p><strong>A. 交易输入    B. 交易输出     C. 交易哈希      D. 交易金额</strong></p>
<p>（<strong>三）简答题（任选3道）</strong></p>
<p><strong>1. 请简述比特币系统的区块链中各个区块是怎么链接的</strong>？</p>
<p><strong>2. 请简述比特币系统的“账户地址”是怎样计算生成的</strong>？</p>
<p><strong>3. 请简单分析比特币系统PoW共识机制节点竞争计算生成新区块的过程</strong>？</p>
<p><strong>4. 请简述比特币系统的出块激励规则</strong>？</p>
<p><strong>5. 请简述比特币系统如何处理竞争出块冲突和孤块</strong></p>
<p><strong>6.什么是比特币区块链系统的Layer2技术，请分析一个典型的比特币Layer2项目？</strong></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://kizzy899.github.io">kizy</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://kizzy899.github.io/2024/12/08/%E9%93%BE%E5%8E%9F%E2%80%94%E2%80%94%E6%AF%94%E7%89%B9%E5%B8%81%E7%B3%BB%E7%BB%9F/">https://kizzy899.github.io/2024/12/08/%E9%93%BE%E5%8E%9F%E2%80%94%E2%80%94%E6%AF%94%E7%89%B9%E5%B8%81%E7%B3%BB%E7%BB%9F/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://kizzy899.github.io" target="_blank">EIGHTJIU</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/">区块链</a></div><div class="post-share"><div class="social-share" data-image="/cover/cover11.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2024/12/11/%E9%93%BE%E5%8E%9F%E2%80%94%E2%80%94%E4%BB%A5%E5%A4%AA%E5%9D%8A%E7%B3%BB%E7%BB%9F/" title="链原——以太坊系统"><img class="cover" src="/cover/cover9.jpg" onerror="onerror=null;src='/img/404page.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">链原——以太坊系统</div></div><div class="info-2"><div class="info-item-1">以太坊系统以太坊区块链系统架构以太坊区块链系统依然是P2P体系结构，即对等网络结构 以太坊系统每个节点都可以存储完整的区块链与账本数据，每个节点都可以发起和监听以太坊网络上的交易信息，验证每个交易和区块的合法性； 每个节点都可以交易的形式发布智能合约，智能合约将存储于区块链中，加载到每个节点上的以太坊虚拟机EVM中执行 虽然每个以太坊系统节点上都安装了对等的以太坊系统软件，但是每个节点可以自由选择启动以太坊系统的不同功能，从而属于不同的节点类型，在区块链网络中扮演不同的角色。目前，以太坊系统的节点总体上可以分为“全节点”、“轻节点”、“存档节点”等类型，其中发挥核心作用的是全节点。 【1】 系统逻辑架构【2】 以太坊系统的存储层主要采用文件系统和LevelDB Key-Value数据库，为以太坊系统相关的区块链、分布式账本、智能合约、X.509数字证书、日志、配置文件等数据提供高效、可靠持久化存储服务。 以太坊系统的数据层是系统核心功能层级之一，对以太坊系统核心的区块、区块链、交易、账本、账户、地址、状态树、交易树、收据树等关键数据结构进行定义和处理，负责将交易打包进区块，由区块...</div></div></div></a><a class="pagination-related" href="/2024/12/01/WEB%E5%AE%89%E5%85%A8/" title="WEB安全"><img class="cover" src="/cover/cover5.jpg" onerror="onerror=null;src='/img/404page.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">WEB安全</div></div><div class="info-2"><div class="info-item-1">如何实施安全评估：资产等级划分—威胁建模—风险分析—设计安全方案  资产等级划分  划分信任域   根据网络逻辑划分（信任程度：数据库&gt;web应用&gt;Internet） 互联网安全核心——数据安全  威胁建模  找出威胁 方法：STRIDE模型    威胁 定义 对应安全属性    Spoofing(伪装) 冒充他人身份 认证   Tampering（篡改） 修改数据或代码 完整性   Repudiation（抵赖） 否认做过的事情 不可抵赖性   Information Disclosure(信息泄露) 机密信息泄露 机密性   Denial of service(拒绝服务) 拒绝服务 可用性   Elevation of Privilege(提升权限) 未经授权获得许可 授权    风险分析  判断风险高低（风险&#x3D;可能性*潜在危害）  方法：DREAD模型  设计安全方案  安全是产品的属性 优秀安全方案所具备特点：  能够解决问题 用户体验好 高性能 低耦合 易于扩展与升级  安全方案设计原则： 1.“默认安全原则” a.    专家系统：黑名单&amp...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/04/12/DAO/" title="DAO"><img class="cover" src="/cover/cover2.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-12</div><div class="info-item-2">DAO</div></div><div class="info-2"><div class="info-item-1">一、DAO 基础概念什么是 DAO（去中心化自治组织）定义：  Decentralized：基于区块链，由利益相关者共同决策。 Autonomous：运行逻辑由智能合约执行，在特定情况下无需人工干预。 DAO 是一个自主存在于网络中的实体，由公开透明的代码编码组织规则，管理组织资产。  特点：  社区治理：以集体方式作出决策（某种方式为自己做决定）。 资产管理：拥有和分配内部资产的能力（包含内部资产，且它有能力将该资产用于奖励某些活动）。  DAO vs 传统公司   特性 DAO 公司    管理结构 自下而上，去中心化 自上而下，层级分明   决策透明度 公开透明 相对封闭   成员参与方式 自主发起，自愿参与 由雇佣关系或股份结构决定   目标 社区共识，长期共赢 股东利润最大化   DAO 的类别 Protocol DAO：Uniswap、MakerDAO   Social DAO：SeedClub、FWB   Venture DAO：CultDAO   Media DAO：Bankless DAO   Grant DAO：Gitcoin   dao究竟在做什么（1）去中...</div></div></div></a><a class="pagination-related" href="/2025/06/07/ERC721/" title="ERC721"><img class="cover" src="/cover/cover2.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-06-07</div><div class="info-item-2">ERC721</div></div><div class="info-2"><div class="info-item-1">12import &quot;@openzeppelin/contracts/token/ERC721/ERC721.sol&quot;;    定义非同质化代币（也称为契约）的标准接口。 每个符合 ERC-721 的合约都必须实现ERC721和ERC165接口  它更大的想象空间在于将物理世界的资产映射到区块链上。  谜恋猫是第一个实现了ERC721 标准的去中心化应用  ERC20代币是可置换的，且可细分为N份（1 &#x3D; 10 * 0.1）, 而ERC721的Token最小的单位为1，无法再分割。    如果同一个集合的两个物品具有不同的特征，这两个物品是非同质的，而同质是某个部分或数量可以被另一个同等部分或数量所代替。  钱包接口123456789101112131415/// @dev Note: the ERC-165 identifier for this interface is 0x150b7a02.interface ERC721TokenReceiver &#123;    /// @notice Handle the receipt of an NF...</div></div></div></a><a class="pagination-related" href="/2025/03/29/DEX/" title="DEX&amp;CEX"><img class="cover" src="/cover/cover4.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-29</div><div class="info-item-2">DEX&amp;CEX</div></div><div class="info-2"><div class="info-item-1">DEX &amp; CEXCEX vs DEX 核心知识点总结1. CEX（中心化交易所） 托管模式：用户资产由交易所控制，存在平台跑路风险。 透明度低：交易记录不公开，依赖交易所的内部账本。 流动性来源：主要依赖专业做市商提供深度。 KYC要求：必须完成身份认证才能交易（合规要求）。 典型代表：Binance、Coinbase、Kraken。  2. DEX（去中心化交易所） 非托管模式：用户自持私钥，资产存于个人钱包（如MetaMask）。 链上透明：所有交易记录公开可查（如Etherscan）。 流动性来源： AMM 模式（如Uniswap）：依赖流动性池（LP提供）。 订单簿模式（如dYdX）：可能结合做市商。   无需许可：无需KYC，支持匿名交易。 典型代表：Uniswap、SushiSwap、dYdX。  Token的作用？ 作为数字资产在区块链上流通   代表项目权益或使用权   提供激励机制（如质押、治理）   增强生态内流动性   早期融资：帮助项目方（尤其是小团队）筹集启动资金（如通过IDO&#x2F;IEO）。 社区治理：代币持有者可参与DAO投票，影响项...</div></div></div></a><a class="pagination-related" href="/2025/05/24/Foundry%E6%A1%86%E6%9E%B6/" title="Foundry框架"><img class="cover" src="/cover/cover8.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-24</div><div class="info-item-2">Foundry框架</div></div><div class="info-2"><div class="info-item-1">定义Foundry 是一个由 Paradigm开发的智能合约开发工具包，用于在以太坊区块链上开发应用程序。Foundry 基于 Rust 运行，提供多种工具来开发和测试 Solidity 智能合约。Foundry 具有一套 CLI 命令，使创建新项目、编译、部署和与合约交互变得简单。 创建Foundry项目 安装命令：  12curl -L &lt;https://foundry.paradigm.xyz&gt; | bash  //下载foundryupfoundryup   //运行它安装 Foundry   安装后，有三个命令行工具 forge, cast, anvil 组成  forge: 用来执行初始化项目、管理依赖、测试、构建、部署智能合约 ; cast: 执行以太坊 RPC 调用的命令行工具, 进行智能合约调用、发送交易或检索任何类型的链数据 anvil: 创建一个本地测试网节点, 也可以用来分叉其他与 EVM 兼容的网络。    初始化  通过 forge 的 forge init 初始化项目 1forge init &lt;project_name&gt;  i...</div></div></div></a><a class="pagination-related" href="/2025/05/24/Hardhat/" title="Hardhat框架"><img class="cover" src="/cover/cover10.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-24</div><div class="info-item-2">Hardhat框架</div></div><div class="info-2"><div class="info-item-1">定义Hardhat 是一个由 Nomiclabs 构建和维护的以太坊智能合约开发环境。它是一个可扩展的 Javascript 框架，提供了一套管理智能合约生命周期的工具和功能，包括编译、部署、测试和调试。 可以用npm直接安装： 12npm install hardhatnpx hardhat init     高度可定制性：Hardhat 的插件系统允许开发者通过自定义插件扩展其功能。  Hardhat 使用 Node 进行包管理，如果你熟悉 Node 及 Javascript， Hardhat 将非常简单上手。 创建Hardhat项目 创建项目目录  12mkdir hardhat-tutorialcd hardhat-tutorial   初始化Node项目  1npm init     安装Hardhat  1npm install --save-dev hardhat   将hatdhat添加到 package.json 的 devDependencies 中，而不是 dependencies 中   在安装Hatdhat的目录下运行 1npx hardhat    使...</div></div></div></a><a class="pagination-related" href="/2024/12/26/FISCOBCOS%E8%81%94%E7%9B%9F%E9%93%BE/" title="FISCO BCOS联盟链"><img class="cover" src="/cover/cover3.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-12-26</div><div class="info-item-2">FISCO BCOS联盟链</div></div><div class="info-2"><div class="info-item-1">FISCO BCOS介绍FISCO BCOS 是一个稳定、高效、安全的区块链底层平台。联盟链需要多家机构来组成联盟，所以FISCO BCOS 支持多群组概念，这意味着多个组织可以通过FISCOBCOS的联盟链组成多个联盟，而且联盟中可以允许共同的组织节点。如下图所示，在多群组技术下FISCO BCOS可以支持众多应用领域。 逻辑架构以下是FISCO BCOS 的逻辑架构，分为：基础层、互联核心层、链核心层、管理层和接口层。  基础层 基础层提供区块链的基础数据结构和算法库，包括密码学算法、隐私算法等。 链核心层 链核心层主要实现区块链的链式数据结构和数据存储（分布式存储），采用了不同的数据库（LevelDB、MySQL、Qracle）来存储区块数据。 互联核心层 互联核心层实现了区块链的基础 P2P 网络通信、共识机制和区块同步机制。 管理层 相对于区块链基础架构，FISCO BCOS 细分出了管理层，实现区块链的管理功能，比如说参数配置、账本管理等。 接口层 接口层主要对应的是应用层，面向区块链用户，提供交互式控制台与各类应用接口。同时还包括智能合约与DApp。 区块链交易流程...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="giscus-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/aaaset/touxiang.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">kizy</div><div class="author-info-description">rainbow</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">67</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">10</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/kizzy899"><i class="fab fa-github"></i><span>my github</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/kizzy899" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">Sampre avanti</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AF%94%E7%89%B9%E5%B8%81%E5%8C%BA%E5%9D%97%E9%93%BE%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84"><span class="toc-number">1.</span> <span class="toc-text">比特币区块链系统架构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E4%BA%8E%E8%8A%82%E7%82%B9"><span class="toc-number">1.1.</span> <span class="toc-text">关于节点</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%A8%E8%8A%82%E7%82%B9"><span class="toc-number">1.1.1.</span> <span class="toc-text">全节点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BD%BB%E8%8A%82%E7%82%B9"><span class="toc-number">1.1.2.</span> <span class="toc-text">轻节点</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E9%80%BB%E8%BE%91%E6%9E%B6%E6%9E%84"><span class="toc-number">1.2.</span> <span class="toc-text">系统逻辑架构</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AF%94%E7%89%B9%E5%B8%81%E7%B3%BB%E7%BB%9F%E6%95%B0%E6%8D%AE%E5%B1%82"><span class="toc-number">2.</span> <span class="toc-text">比特币系统数据层</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8C%BA%E5%9D%97%E4%B8%8E%E5%8C%BA%E5%9D%97%E9%93%BE"><span class="toc-number">2.1.</span> <span class="toc-text">区块与区块链</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B4%A6%E6%9C%AC%E6%95%B0%E6%8D%AE"><span class="toc-number">2.1.1.</span> <span class="toc-text">账本数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#UTXO"><span class="toc-number">2.1.2.</span> <span class="toc-text">UTXO</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%A4%E6%98%93%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="toc-number">2.1.3.</span> <span class="toc-text">交易数据结构</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BA%A4%E6%98%93%E8%BE%93%E5%85%A5%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="toc-number">2.1.3.1.</span> <span class="toc-text">交易输入数据结构</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BA%A4%E6%98%93%E8%BE%93%E5%87%BA%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="toc-number">2.1.3.2.</span> <span class="toc-text">交易输出数据结构</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%8A%B6%E6%80%81%E6%95%B0%E6%8D%AE"><span class="toc-number">2.1.4.</span> <span class="toc-text">状态数据</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AF%94%E7%89%B9%E5%B8%81%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E5%B1%82"><span class="toc-number">2.2.</span> <span class="toc-text">比特币系统网络层</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#P2P%E7%BD%91%E7%BB%9C%E7%BB%93%E6%9E%84"><span class="toc-number">2.2.1.</span> <span class="toc-text">P2P网络结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%A8%E8%8A%82%E7%82%B9-1"><span class="toc-number">2.2.2.</span> <span class="toc-text">全节点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BD%BB%E8%8A%82%E7%82%B9-1"><span class="toc-number">2.2.3.</span> <span class="toc-text">轻节点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8A%82%E7%82%B9%E5%8F%91%E7%8E%B0%E7%AE%A1%E7%90%86"><span class="toc-number">2.2.4.</span> <span class="toc-text">节点发现管理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%A4%E6%98%93%E5%B9%BF%E6%92%AD"><span class="toc-number">2.2.5.</span> <span class="toc-text">交易广播</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%A4%E6%98%93%E6%B1%A0"><span class="toc-number">2.2.6.</span> <span class="toc-text">交易池</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8C%BA%E5%9D%97%E5%B9%BF%E6%92%AD%E4%B8%8E%E5%90%8C%E6%AD%A5"><span class="toc-number">2.2.7.</span> <span class="toc-text">区块广播与同步</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AF%94%E7%89%B9%E5%B8%81%E7%B3%BB%E7%BB%9F%E5%85%B1%E8%AF%86%E5%B1%82"><span class="toc-number">2.3.</span> <span class="toc-text">比特币系统共识层</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#PoW%E5%B7%A5%E4%BD%9C%E9%87%8F%E8%AF%81%E6%98%8E%E5%85%B1%E8%AF%86%E6%9C%BA%E5%88%B6"><span class="toc-number">2.3.1.</span> <span class="toc-text">PoW工作量证明共识机制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PoW%E5%85%B1%E8%AF%86%E6%9C%BA%E5%88%B6%E7%9A%84%E7%89%B9%E7%82%B9"><span class="toc-number">2.3.2.</span> <span class="toc-text">PoW共识机制的特点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AB%9E%E4%BA%89%E5%87%BA%E5%9D%97%E5%86%B2%E7%AA%81"><span class="toc-number">2.3.3.</span> <span class="toc-text">竞争出块冲突</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AF%94%E7%89%B9%E5%B8%81%E7%B3%BB%E7%BB%9F%E6%BF%80%E5%8A%B1%E5%B1%82"><span class="toc-number">2.4.</span> <span class="toc-text">比特币系统激励层</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BF%80%E5%8A%B1%E6%9C%BA%E5%88%B6"><span class="toc-number">2.4.1.</span> <span class="toc-text">激励机制</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AF%94%E7%89%B9%E5%B8%81%E7%B3%BB%E7%BB%9F%E5%90%88%E7%BA%A6%E5%B1%82"><span class="toc-number">2.5.</span> <span class="toc-text">比特币系统合约层</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AF%94%E7%89%B9%E5%B8%81%E7%B3%BB%E7%BB%9F%E7%9A%84%E4%BA%A4%E6%98%93%E8%84%9A%E6%9C%AC"><span class="toc-number">2.5.1.</span> <span class="toc-text">比特币系统的交易脚本</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%A4%E6%98%93%E8%84%9A%E6%9C%AC%E6%89%A7%E8%A1%8C%E6%9C%BA%E5%88%B6"><span class="toc-number">2.5.2.</span> <span class="toc-text">交易脚本执行机制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%A4%E6%98%93%E6%A0%87%E5%87%86%E8%84%9A%E6%9C%AC"><span class="toc-number">2.5.3.</span> <span class="toc-text">交易标准脚本</span></a></li></ol></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url(/img/aaaset/title.png);"><div class="footer-other"><div class="footer-copyright"></div><div class="footer_custom_text">-899</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const getGiscusTheme = theme => theme === 'dark' ? 'dark' : 'light'

  const createScriptElement = config => {
    const ele = document.createElement('script')
    Object.entries(config).forEach(([key, value]) => {
      ele.setAttribute(key, value)
    })
    return ele
  }

  const loadGiscus = (el = document, key) => {
    const mappingConfig = isShuoshuo
      ? { 'data-mapping': 'specific', 'data-term': key }
      : { 'data-mapping': (option && option['data-mapping']) || 'pathname' }

    const giscusConfig = {
      src: 'https://giscus.app/client.js',
      'data-repo': 'kizzy899/kizzy899.github.io',
      'data-repo-id': 'R_kgDONCC1iQ',
      'data-category-id': 'DIC_kwDONCC1ic4CtwTu',
      'data-theme': getGiscusTheme(document.documentElement.getAttribute('data-theme')),
      'data-reactions-enabled': '1',
      crossorigin: 'anonymous',
      async: true,
      ...option,
      ...mappingConfig
    }

    const scriptElement = createScriptElement(giscusConfig)

    el.querySelector('#giscus-wrap').appendChild(scriptElement)

    if (isShuoshuo) {
      window.shuoshuoComment.destroyGiscus = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }
  }

  const changeGiscusTheme = theme => {
    const iframe = document.querySelector('#giscus-wrap iframe')
    if (iframe) {
      const message = {
        giscus: {
          setConfig: {
            theme: getGiscusTheme(theme)
          }
        }
      }
      iframe.contentWindow.postMessage(message, 'https://giscus.app')
    }
  }

  btf.addGlobalFn('themeChange', changeGiscusTheme, 'giscus')

  if (isShuoshuo) {
    'Giscus' === 'Giscus'
      ? window.shuoshuoComment = { loadComment: loadGiscus }
      : window.loadOtherComment = loadGiscus
    return
  }

  if ('Giscus' === 'Giscus' || !false) {
    if (false) btf.loadComment(document.getElementById('giscus-wrap'), loadGiscus)
    else loadGiscus()
  } else {
    window.loadOtherComment = loadGiscus
  }
})()</script></div><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="false" data-text="8,9,小,金" data-fontsize="15px" data-random="false" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>