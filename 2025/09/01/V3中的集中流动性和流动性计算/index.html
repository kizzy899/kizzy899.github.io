<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>V3中的集中流动性和流动性计算 | EIGHTJIU</title><meta name="author" content="kizy"><meta name="copyright" content="kizy"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="集中流动性（Concentrated Liquidity）传统的 AMM 流动性是整个价格曲线连续分布的，而 V3 允许 LP（流动性提供者）把资金集中在某个 价格区间 [P_min, P_max] 内。 1. 背景在 Uniswap V2 中，流动性提供者（LP）是 全价区间流动性 模式：  流动性必须从 0 到 ∞ 的价格范围内均匀分布。 结果是，大部分资本几乎不会被用到（因为实际交易只发生在">
<meta property="og:type" content="article">
<meta property="og:title" content="V3中的集中流动性和流动性计算">
<meta property="og:url" content="https://kizzy899.github.io/2025/09/01/V3%E4%B8%AD%E7%9A%84%E9%9B%86%E4%B8%AD%E6%B5%81%E5%8A%A8%E6%80%A7%E5%92%8C%E6%B5%81%E5%8A%A8%E6%80%A7%E8%AE%A1%E7%AE%97/index.html">
<meta property="og:site_name" content="EIGHTJIU">
<meta property="og:description" content="集中流动性（Concentrated Liquidity）传统的 AMM 流动性是整个价格曲线连续分布的，而 V3 允许 LP（流动性提供者）把资金集中在某个 价格区间 [P_min, P_max] 内。 1. 背景在 Uniswap V2 中，流动性提供者（LP）是 全价区间流动性 模式：  流动性必须从 0 到 ∞ 的价格范围内均匀分布。 结果是，大部分资本几乎不会被用到（因为实际交易只发生在">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://kizzy899.github.io/cover/title.jpg">
<meta property="article:published_time" content="2025-09-01T08:15:35.000Z">
<meta property="article:modified_time" content="2025-09-05T04:14:13.920Z">
<meta property="article:author" content="kizy">
<meta property="article:tag" content="Uniswap">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://kizzy899.github.io/cover/title.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "V3中的集中流动性和流动性计算",
  "url": "https://kizzy899.github.io/2025/09/01/V3%E4%B8%AD%E7%9A%84%E9%9B%86%E4%B8%AD%E6%B5%81%E5%8A%A8%E6%80%A7%E5%92%8C%E6%B5%81%E5%8A%A8%E6%80%A7%E8%AE%A1%E7%AE%97/",
  "image": "https://kizzy899.github.io/cover/title.jpg",
  "datePublished": "2025-09-01T08:15:35.000Z",
  "dateModified": "2025-09-05T04:14:13.920Z",
  "author": [
    {
      "@type": "Person",
      "name": "kizy",
      "url": "https://kizzy899.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/tubiao.png"><link rel="canonical" href="https://kizzy899.github.io/2025/09/01/V3%E4%B8%AD%E7%9A%84%E9%9B%86%E4%B8%AD%E6%B5%81%E5%8A%A8%E6%80%A7%E5%92%8C%E6%B5%81%E5%8A%A8%E6%80%A7%E8%AE%A1%E7%AE%97/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'V3中的集中流动性和流动性计算',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/_custom/custom.css"><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(/img/aaaset/page.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/aaaset/touxiang.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">68</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">10</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/search/"><i class="fa-fw fas fa-search"></i><span> Search</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> link</span></a></li><li><a class="site-page child" href="/star/"><i class="fa-fw fas fa-star"></i><span> star</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/cover/title.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">EIGHTJIU</span></a><a class="nav-page-title" href="/"><span class="site-name">V3中的集中流动性和流动性计算</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/search/"><i class="fa-fw fas fa-search"></i><span> Search</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> link</span></a></li><li><a class="site-page child" href="/star/"><i class="fa-fw fas fa-star"></i><span> star</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></li></ul></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">V3中的集中流动性和流动性计算</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-09-01T08:15:35.000Z" title="发表于 2025-09-01 16:15:35">2025-09-01</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-09-05T04:14:13.920Z" title="更新于 2025-09-05 12:14:13">2025-09-05</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="集中流动性（Concentrated-Liquidity）"><a href="#集中流动性（Concentrated-Liquidity）" class="headerlink" title="集中流动性（Concentrated Liquidity）"></a>集中流动性（Concentrated Liquidity）</h1><p>传统的 AMM 流动性是整个价格曲线连续分布的，而 V3 允许 LP（流动性提供者）把资金集中在某个 <strong>价格区间 [P_min, P_max]</strong> 内。</p>
<h3 id="1-背景"><a href="#1-背景" class="headerlink" title="1. 背景"></a>1. 背景</h3><p>在 <strong>Uniswap V2</strong> 中，流动性提供者（LP）是 <strong>全价区间流动性</strong> 模式：</p>
<ul>
<li>流动性必须从 <strong>0 到 ∞</strong> 的价格范围内均匀分布。</li>
<li>结果是，大部分资本几乎不会被用到（因为实际交易只发生在某个较小的价格区间）。</li>
<li>这导致资本利用率很低。</li>
</ul>
<hr>
<h3 id="2-集中流动性的核心思想"><a href="#2-集中流动性的核心思想" class="headerlink" title="2. 集中流动性的核心思想"></a>2. 集中流动性的核心思想</h3><p><strong>集中流动性（Concentrated Liquidity）</strong>：<br> 流动性提供者（LP）不再需要把资金放在整个价格区间，而是可以选择 <strong>某个价格区间</strong> 来提供流动性。</p>
<p>比如：</p>
<ul>
<li>你可以只在 <code>1000–2000 USDC/ETH</code> 区间提供流动性。</li>
<li>如果 ETH 价格一直在 1500–1800 之间，你的资金就几乎全都在发挥作用。</li>
</ul>
<hr>
<h3 id="3-技术实现"><a href="#3-技术实现" class="headerlink" title="3. 技术实现"></a>3. 技术实现</h3><p>Uniswap V3 的做法是：</p>
<ul>
<li>把价格区间离散化为一系列 <strong>ticks（刻度）</strong>。</li>
<li>LP 在提交流动性时，要指定一个区间 <code>[tickLower, tickUpper]</code>。</li>
<li>只有当当前价格落在区间内时，该 LP 的流动性才会被激活。</li>
<li>交易时会优先消耗当前价格范围内的流动性，如果不足，就跨区间继续往外找。</li>
</ul>
<hr>
<h3 id="4-带来的优势"><a href="#4-带来的优势" class="headerlink" title="4. 带来的优势"></a>4. 带来的优势</h3><ol>
<li><strong>资本效率更高</strong><ul>
<li>在 V2，假设要获得 1 倍的手续费收益，需要投入 $100,000；</li>
<li>在 V3，集中流动性可以让同样的收益只需要 $10,000，因为资金更“集中”。</li>
</ul>
</li>
<li><strong>更灵活</strong><ul>
<li>LP 可以选择做“窄区间”，高风险高回报；</li>
<li>也可以做“宽区间”，低风险低回报。</li>
</ul>
</li>
<li><strong>不同 LP 之间差异化</strong><ul>
<li>V2 中 LP 基本上是同质化的；</li>
<li>V3 中 LP 更像是 <strong>做市商（Market Maker）</strong>，可以有不同策略。</li>
</ul>
</li>
</ol>
<hr>
<h3 id="5-风险与挑战"><a href="#5-风险与挑战" class="headerlink" title="5. 风险与挑战"></a>5. 风险与挑战</h3><ul>
<li><strong>无常损失更高</strong><br> 集中流动性意味着如果价格突破区间，你的资金就会完全变成单边资产。</li>
<li><strong>管理成本增加</strong><br> LP 必须频繁调整区间（需要“再平衡”），类似传统的做市商。</li>
<li><strong>更复杂的合约设计</strong><br> 因为 V3 要管理很多区间流动性，使用了 <strong>NFT（Non-Fungible Token）</strong> 来代表 LP 的头寸。</li>
</ul>
<h2 id="官方案例"><a href="#官方案例" class="headerlink" title="官方案例"></a>官方案例</h2><p>盈利：</p>
<p><img src="https://s2.loli.net/2025/09/01/NIZEPvBmekRyO4K.png" alt="image.png"></p>
<p>亏损：</p>
<p><img src="https://s2.loli.net/2025/09/01/D1rIejig2qfCYwQ.jpg" alt="f5b8cc501c9e3df65077a58ac43040e0.jpg"></p>
<h1 id="流动性计算"><a href="#流动性计算" class="headerlink" title="流动性计算"></a>流动性计算</h1><h2 id="虚拟流动性"><a href="#虚拟流动性" class="headerlink" title="虚拟流动性"></a>虚拟流动性</h2><p><strong>虚拟流动性（Virtual Liquidity）</strong> 是 Uniswap V3 中的一项关键概念，它与传统的流动性提供有所不同。它主要是为了解决 <strong>集中流动性</strong> 模式下的一些问题，尤其是在交易对价格不在你的提供流动性区间时如何处理流动性。</p>
<h3 id="1-集中流动性带来的问题"><a href="#1-集中流动性带来的问题" class="headerlink" title="1. 集中流动性带来的问题"></a>1. 集中流动性带来的问题</h3><p>在 <strong>Uniswap V3</strong> 中，流动性被集中在某个 <strong>价格区间</strong> 内，只有当价格落在该区间时，流动性才会生效。如果价格不在你设定的区间内，你提供的流动性将不会被使用，甚至你可能完全失去盈利机会。</p>
<p><strong>虚拟流动性</strong> 是为了应对这一问题而提出的，它能让未被激活的流动性在某些情况下“虚拟”地参与交易。</p>
<hr>
<h3 id="2-虚拟流动性是怎么工作的？"><a href="#2-虚拟流动性是怎么工作的？" class="headerlink" title="2. 虚拟流动性是怎么工作的？"></a>2. 虚拟流动性是怎么工作的？</h3><ul>
<li>在 Uniswap V3 中，当价格离开某个流动性提供区间时，流动性会被“锁住”在这个区间内，直到价格回到该区间才会被激活。</li>
<li><strong>虚拟流动性</strong> 允许你提供的流动性 <strong>在价格不在你区间时也能参与交易</strong>。这通过特定的算法（如虚拟费用模型）来实现，可以在价格偏离你的区间时，为你带来 <strong>类似流动性的收益</strong>。</li>
</ul>
<hr>
<h3 id="3-具体实现原理"><a href="#3-具体实现原理" class="headerlink" title="3. 具体实现原理"></a>3. 具体实现原理</h3><p>虚拟流动性主要通过以下方式实现：</p>
<ul>
<li><strong>流动性和交易对价位的映射</strong><br> 在 Uniswap V3 中，价格区间的 <strong>流动性提供者（LP）</strong> 是通过 <strong>tick</strong> 来管理的。每个 tick 都代表一个价格范围。当价格穿越 tick 时，流动性会在池中进行“转移”或激活。</li>
<li><strong>虚拟流动性：</strong> 这就像是在交易对的 <strong>虚拟池</strong> 中存在的一种流动性，它不是直接提供的，但它对交易过程中的 <strong>交易路径计算</strong> 有影响。在算法中，这种流动性帮助估算交易是否能在 <strong>当前价格范围外</strong> 完成。</li>
<li><strong>动态调整</strong><br> 即使价格不在你的区间内，Uniswap 也会通过 <strong>虚拟流动性</strong> 保持对你的流动性的一定影响，从而保证你的资本可以最大化利用。</li>
</ul>
<hr>
<h3 id="4-例如：与实际流动性比较"><a href="#4-例如：与实际流动性比较" class="headerlink" title="4. 例如：与实际流动性比较"></a>4. 例如：与实际流动性比较</h3><p>假设你作为 LP 提供了 <code>1000 A + 10 B</code> 的流动性，设定的区间是 <code>[1000/10, 1200/12]</code>（即价格在 <code>100 A = 1 B</code> 到 <code>120 A = 1 B</code> 之间）。</p>
<ul>
<li>如果市场价格在 <code>100 A = 1 B</code> 到 <code>120 A = 1 B</code> 区间内，这时你的流动性 <strong>真实生效</strong>，并且交易可以在该区间内顺利完成。</li>
<li>如果价格跌至 <code>90 A = 1 B</code> 以下，或者涨到 <code>130 A = 1 B</code> 以上，且没有市场需求触及到你的流动性区间，那么你的流动性将处于 <strong>虚拟状态</strong>，但你的资本仍然在算法计算中有效，<strong>虚拟流动性</strong> 会影响市场路径和价格的波动。</li>
</ul>
<hr>
<h3 id="5-虚拟流动性的优势"><a href="#5-虚拟流动性的优势" class="headerlink" title="5. 虚拟流动性的优势"></a>5. 虚拟流动性的优势</h3><ul>
<li><strong>提高资金效率</strong>：通过虚拟流动性，LP 的资金可以更广泛地用于市场交易，即使价格不在指定的区间内。</li>
<li><strong>保证收益机会</strong>：即使价格在你设定的区间外，仍然有机会通过虚拟流动性获得手续费收益。</li>
</ul>
<hr>
<h3 id="6-结论"><a href="#6-结论" class="headerlink" title="6. 结论"></a>6. 结论</h3><ul>
<li><strong>虚拟流动性</strong> 并不直接代表在某个价格区间内的流动性，而是通过智能合约中的算法 <strong>模拟</strong> 你为市场提供的流动性，影响价格和交易路径。</li>
<li>它是 Uniswap V3 集中流动性模型的一部分，目的是 <strong>提高资本效率</strong>，即使流动性没有完全被激活。</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://kizzy899.github.io">kizy</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://kizzy899.github.io/2025/09/01/V3%E4%B8%AD%E7%9A%84%E9%9B%86%E4%B8%AD%E6%B5%81%E5%8A%A8%E6%80%A7%E5%92%8C%E6%B5%81%E5%8A%A8%E6%80%A7%E8%AE%A1%E7%AE%97/">https://kizzy899.github.io/2025/09/01/V3%E4%B8%AD%E7%9A%84%E9%9B%86%E4%B8%AD%E6%B5%81%E5%8A%A8%E6%80%A7%E5%92%8C%E6%B5%81%E5%8A%A8%E6%80%A7%E8%AE%A1%E7%AE%97/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://kizzy899.github.io" target="_blank">EIGHTJIU</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Uniswap/">Uniswap</a></div><div class="post-share"><div class="social-share" data-image="/cover/title.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/09/07/0G%E7%AC%AC%E4%BA%94%E8%AF%BE%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="0G核心模块|AIVerse"><img class="cover" src="/cover/cover_10.jpg" onerror="onerror=null;src='/img/404page.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">0G核心模块|AIVerse</div></div><div class="info-2"><div class="info-item-1">ERC7857（iNFT）什么是 ERC7857&#x2F;INFTERC-7857（也称 INFT）是一种面向 智能体&#x2F;AI 代理的 NFT 标准，支持 可进化元数据、加密功能元数据以及功能性资产的安全转移，弥补传统 ERC-721 在 AI 场景中的不足。 NFT 不适配 AI 的原因1. Static Metadata（静态元数据） 传统 NFT（如 ERC-721）元数据固定，不支持自我学习或自我演化 无法随着 AI 代理能力或状态变化而更新  2. Insecure Metadata Transfer（元数据传输不安全） NFT 转移只涉及所有权转移 底层功能性元数据未随之安全转移 存在信息泄露或功能丢失风险  3. Publicly Accessible Metadata（元数据公开可访问） NFT 元数据默认公开 缺少原生加密机制 关键功能或敏感信息无法保护  REC7857的技术细节步骤  调用 transfer() 方法，开启转账流程。 合约向 Oracle 发起询问，询问目标 “newDataHash” 相关情况。 Oracle 回复接收方是否能访问...</div></div></div></a><a class="pagination-related" href="/2025/09/01/V2%E4%B8%AD%E7%9A%84%E9%97%AA%E7%94%B5%E8%B4%B7%E5%92%8CTWAP/" title="V2中的闪电贷和TWAP"><img class="cover" src="/aaaset/cover_17.jpg" onerror="onerror=null;src='/img/404page.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">V2中的闪电贷和TWAP</div></div><div class="info-2"><div class="info-item-1">Flash Swap什么是闪电贷闪电贷 是一种 无需抵押的贷款机制，主要出现在 DeFi（去中心化金融）协议里。 它的核心特点是：  用户可以瞬间借到大量资金（几乎没有上限，只受池子流动性限制）。 必须在同一个交易（同一个区块内）还清。 如果没有还清，整个交易会直接被回滚（就像从没发生过一样）。 所以协议提供者不会有风险。    闪电贷有什么用？ 套利 不同交易所（比如 Uniswap、SushiSwap、Curve）之间价格差异，瞬间搬运套利。   清算 在借贷协议（比如 Aave、Compound）里，当有人抵押物不足时，你可以用闪电贷借钱去清算，然后赚取奖励。   抵押物替换 假如你在 MakerDAO 抵押 ETH 借了 DAI，但想换成 WBTC 抵押，可以用闪电贷无缝替换，不需要先卖掉 ETH 再买 BTC。   高杠杆操作 利用瞬时借贷，把本金放大很多倍，进行投机或策略。    为什么 Uniswap V2 也能提供闪电贷？ Uniswap V2 引入了一个机制：你可以拿走池子里的代币，只要在交易结束前归还相同数量的代币（或等值代币）。 这正好可以被用来实现 闪电贷...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/08/06/Uniswap%E4%B8%93%E9%A1%B9/" title="Uniswap专项"><img class="cover" src="/cover/cover_11.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-08-06</div><div class="info-item-2">Uniswap专项</div></div><div class="info-2"><div class="info-item-1">恒定乘积自动做市商算法核心公式恒定乘积做市商的核心公式是：x * y = k其中：  ( x ) 是第一种资产的数量（如ETH） ( y ) 是第二种资产的数量（如USDT） ( k ) 是常数乘积  价格变动机制当交易发生时，资产数量的变化遵循：[ (x + dx)(y - dy) &#x3D; k ][ (x - dx)(y + dy) &#x3D; k ] 滑点计算滑点计算公式（纯文本格式）滑点(S) &#x3D; [(实际执行价格 - 预期价格) &#x2F; 预期价格] × 100% 变量说明： 滑点(S)：以百分比(%)表示的价格偏差 实际执行价格：交易实际成交的价格 预期价格：交易发起时预期的市场价格  示例：如果预期价格是2000 USDT，实际执行价格是2666.66 USDT，那么：滑点 &#x3D; [(2666.66 - 2000)&#x2F;2000] × 100% &#x3D; 33.33% 公式解读： 先计算实际价格与预期价格的差值 将差值除以预期价格，得到相对偏差 乘以100%转换为百分比形式  注意事项： 正值表示实际价格高于预期（对买方不利） ...</div></div></div></a><a class="pagination-related" href="/2025/08/31/UniswapV2%E4%B8%AD%E7%9A%84swap%E6%93%8D%E4%BD%9C%E5%92%8C%E6%89%8B%E7%BB%AD%E8%B4%B9%E6%9C%BA%E5%88%B6/" title="V2中的swap操作和手续费机制"><img class="cover" src="/cover/cover7.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-08-31</div><div class="info-item-2">V2中的swap操作和手续费机制</div></div><div class="info-2"><div class="info-item-1">Swap操作关于DAI&#x2F;USDT的单交换 逻辑：  Router02.sol   SwapexactTokensForTokens( ) SwapTokensForexactTokens( )   资金转换 transferFrom( ) [ pair DAI&#x2F;USDT]  Swap   transfer(币转给用户)    多Tokens之间的交换此时path参数 1path = [DAI, WBTC, USDC];  流程图：  逻辑：  用户调用 Router02 的 swapExactTokensForTokens，传入 path = [DAI, WBTC, USDC]。  Router02 先把用户的 DAI 转入 DAI-WBTC Pair。  DAI-WBTC Pair 执行 swap，把 WBTC 发给下一个 Pair（由 Router02 转发）。  Router02 把 WBTC 继续送入 WBTC-USDC Pair。  WBTC-USDC Pair 执行 swap，把 USDC 最终发给用户。  用户完成从 DAI → WBTC → U...</div></div></div></a><a class="pagination-related" href="/2025/08/31/v1-v4%E7%AE%80%E4%BB%8B/" title="Uniswapv1-v4简介"><img class="cover" src="/cover/page2.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-08-31</div><div class="info-item-2">Uniswapv1-v4简介</div></div><div class="info-2"><div class="info-item-1">Uniswap V1 2018年11月2日发布 使用 Vyper 语言编写 仅支持 ERC20-ETH 直接互换或者通过ETH进行互换: 合约地址: Uniswap&#x2F;v1-contracts: Uniswap V1 smartcontracts (github.com)  合约重点：  Exchange——交易逻辑  factory——创建交易对   createchange( )    Uniswap V2 2020年5月发布; 增加 ERC20-ERC20直接互换:。增加 Flash Swap; 增加 Oracle; 改进手续费收取方式; 引爆了 DeFi 赛道; 2020年9月，发行治理代币UNI;   什么是DeFilamaDeFiLlama 是一个 去中心化金融（DeFi）数据聚合平台，主要提供各种区块链 DeFi 协议的统计数据和分析。它的特点是 中立、免费、开源，不像一些由 VC 资助的平台，它更倾向于社区驱动。 DeFiLlama 提供什么功能？ TVL（Total Value Locked）数据 可以看到不同链（以太坊、BSC、Arbitrum、Pol...</div></div></div></a><a class="pagination-related" href="/2025/08/31/V2%E4%B8%AD%E6%B7%BB%E5%8A%A0-%E7%A7%BB%E9%99%A4%E6%B5%81%E5%8A%A8%E6%80%A7/" title="V2中添加&#x2F;移除流动性&amp;无常损失"><img class="cover" src="/cover/cover_10.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-08-31</div><div class="info-item-2">V2中添加&#x2F;移除流动性&amp;无常损失</div></div><div class="info-2"><div class="info-item-1">  前置文章: https://kizzy899.github.io/2025/08/06/Uniswap%E4%B8%93%E9%A1%B9/    项目代码: https://github.com/Uniswap/v2-core/blob/master/contracts/UniswapV2Pair.sol  添加流动性 在 Router.addLiquidity() 流程中：  Router 会先调用 Factory.getPair(tokenA, tokenB) 检查池子是否存在   getPair[token0][token1] 用来查询该交易对是否已经存在 Pair 合约。 如果返回 非零地址，说明这个交易对已经有 Pair 了 → **不会再调用 create2**。 如果返回 零地址，才会用 create2 部署新的 Pair 合约，并初始化。   如果不存在 → Factory.createPair(tokenA, tokenB) 创建一个新的 Pair 合约  然后 Router 才把用户代币转到 Pair 并调用 mint()    mint() : 把用户...</div></div></div></a><a class="pagination-related" href="/2025/09/01/V2%E4%B8%AD%E7%9A%84%E9%97%AA%E7%94%B5%E8%B4%B7%E5%92%8CTWAP/" title="V2中的闪电贷和TWAP"><img class="cover" src="/aaaset/cover_17.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-01</div><div class="info-item-2">V2中的闪电贷和TWAP</div></div><div class="info-2"><div class="info-item-1">Flash Swap什么是闪电贷闪电贷 是一种 无需抵押的贷款机制，主要出现在 DeFi（去中心化金融）协议里。 它的核心特点是：  用户可以瞬间借到大量资金（几乎没有上限，只受池子流动性限制）。 必须在同一个交易（同一个区块内）还清。 如果没有还清，整个交易会直接被回滚（就像从没发生过一样）。 所以协议提供者不会有风险。    闪电贷有什么用？ 套利 不同交易所（比如 Uniswap、SushiSwap、Curve）之间价格差异，瞬间搬运套利。   清算 在借贷协议（比如 Aave、Compound）里，当有人抵押物不足时，你可以用闪电贷借钱去清算，然后赚取奖励。   抵押物替换 假如你在 MakerDAO 抵押 ETH 借了 DAI，但想换成 WBTC 抵押，可以用闪电贷无缝替换，不需要先卖掉 ETH 再买 BTC。   高杠杆操作 利用瞬时借贷，把本金放大很多倍，进行投机或策略。    为什么 Uniswap V2 也能提供闪电贷？ Uniswap V2 引入了一个机制：你可以拿走池子里的代币，只要在交易结束前归还相同数量的代币（或等值代币）。 这正好可以被用来实现 闪电贷...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="giscus-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/aaaset/touxiang.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">kizy</div><div class="author-info-description">rainbow</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">68</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">10</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/kizzy899"><i class="fab fa-github"></i><span>my github</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/kizzy899" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">Sampre avanti</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%9B%86%E4%B8%AD%E6%B5%81%E5%8A%A8%E6%80%A7%EF%BC%88Concentrated-Liquidity%EF%BC%89"><span class="toc-number">1.</span> <span class="toc-text">集中流动性（Concentrated Liquidity）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%83%8C%E6%99%AF"><span class="toc-number">1.0.1.</span> <span class="toc-text">1. 背景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E9%9B%86%E4%B8%AD%E6%B5%81%E5%8A%A8%E6%80%A7%E7%9A%84%E6%A0%B8%E5%BF%83%E6%80%9D%E6%83%B3"><span class="toc-number">1.0.2.</span> <span class="toc-text">2. 集中流动性的核心思想</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%8A%80%E6%9C%AF%E5%AE%9E%E7%8E%B0"><span class="toc-number">1.0.3.</span> <span class="toc-text">3. 技术实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%B8%A6%E6%9D%A5%E7%9A%84%E4%BC%98%E5%8A%BF"><span class="toc-number">1.0.4.</span> <span class="toc-text">4. 带来的优势</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E9%A3%8E%E9%99%A9%E4%B8%8E%E6%8C%91%E6%88%98"><span class="toc-number">1.0.5.</span> <span class="toc-text">5. 风险与挑战</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%98%E6%96%B9%E6%A1%88%E4%BE%8B"><span class="toc-number">1.1.</span> <span class="toc-text">官方案例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%B5%81%E5%8A%A8%E6%80%A7%E8%AE%A1%E7%AE%97"><span class="toc-number">2.</span> <span class="toc-text">流动性计算</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%99%9A%E6%8B%9F%E6%B5%81%E5%8A%A8%E6%80%A7"><span class="toc-number">2.1.</span> <span class="toc-text">虚拟流动性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E9%9B%86%E4%B8%AD%E6%B5%81%E5%8A%A8%E6%80%A7%E5%B8%A6%E6%9D%A5%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">2.1.1.</span> <span class="toc-text">1. 集中流动性带来的问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%99%9A%E6%8B%9F%E6%B5%81%E5%8A%A8%E6%80%A7%E6%98%AF%E6%80%8E%E4%B9%88%E5%B7%A5%E4%BD%9C%E7%9A%84%EF%BC%9F"><span class="toc-number">2.1.2.</span> <span class="toc-text">2. 虚拟流动性是怎么工作的？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%85%B7%E4%BD%93%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86"><span class="toc-number">2.1.3.</span> <span class="toc-text">3. 具体实现原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E4%BE%8B%E5%A6%82%EF%BC%9A%E4%B8%8E%E5%AE%9E%E9%99%85%E6%B5%81%E5%8A%A8%E6%80%A7%E6%AF%94%E8%BE%83"><span class="toc-number">2.1.4.</span> <span class="toc-text">4. 例如：与实际流动性比较</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E8%99%9A%E6%8B%9F%E6%B5%81%E5%8A%A8%E6%80%A7%E7%9A%84%E4%BC%98%E5%8A%BF"><span class="toc-number">2.1.5.</span> <span class="toc-text">5. 虚拟流动性的优势</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E7%BB%93%E8%AE%BA"><span class="toc-number">2.1.6.</span> <span class="toc-text">6. 结论</span></a></li></ol></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url(/img/aaaset/title.png);"><div class="footer-other"><div class="footer-copyright"></div><div class="footer_custom_text">-899</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const getGiscusTheme = theme => theme === 'dark' ? 'dark' : 'light'

  const createScriptElement = config => {
    const ele = document.createElement('script')
    Object.entries(config).forEach(([key, value]) => {
      ele.setAttribute(key, value)
    })
    return ele
  }

  const loadGiscus = (el = document, key) => {
    const mappingConfig = isShuoshuo
      ? { 'data-mapping': 'specific', 'data-term': key }
      : { 'data-mapping': (option && option['data-mapping']) || 'pathname' }

    const giscusConfig = {
      src: 'https://giscus.app/client.js',
      'data-repo': 'kizzy899/kizzy899.github.io',
      'data-repo-id': 'R_kgDONCC1iQ',
      'data-category-id': 'DIC_kwDONCC1ic4CtwTu',
      'data-theme': getGiscusTheme(document.documentElement.getAttribute('data-theme')),
      'data-reactions-enabled': '1',
      crossorigin: 'anonymous',
      async: true,
      ...option,
      ...mappingConfig
    }

    const scriptElement = createScriptElement(giscusConfig)

    el.querySelector('#giscus-wrap').appendChild(scriptElement)

    if (isShuoshuo) {
      window.shuoshuoComment.destroyGiscus = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }
  }

  const changeGiscusTheme = theme => {
    const iframe = document.querySelector('#giscus-wrap iframe')
    if (iframe) {
      const message = {
        giscus: {
          setConfig: {
            theme: getGiscusTheme(theme)
          }
        }
      }
      iframe.contentWindow.postMessage(message, 'https://giscus.app')
    }
  }

  btf.addGlobalFn('themeChange', changeGiscusTheme, 'giscus')

  if (isShuoshuo) {
    'Giscus' === 'Giscus'
      ? window.shuoshuoComment = { loadComment: loadGiscus }
      : window.loadOtherComment = loadGiscus
    return
  }

  if ('Giscus' === 'Giscus' || !false) {
    if (false) btf.loadComment(document.getElementById('giscus-wrap'), loadGiscus)
    else loadGiscus()
  } else {
    window.loadOtherComment = loadGiscus
  }
})()</script></div><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="false" data-text="8,9,小,金" data-fontsize="15px" data-random="false" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>